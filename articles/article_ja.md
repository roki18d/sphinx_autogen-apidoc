# ã¯ã˜ã‚ã«

## a. è¨˜äº‹æ¦‚è¦

* è‡ªä½œ Python ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰è‡ªå‹•ç”Ÿæˆã—ã¦ã„ãã¾ã™ã€‚
* ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆãƒ„ãƒ¼ãƒ«ã§ã‚ã‚‹ [Sphinx](https://www.sphinx-doc.org/en/master/) ãŠã‚ˆã³ã€ãã®æ‹¡å¼µæ©Ÿèƒ½ã§ã‚ã‚‹ [Napoleon](https://sphinxcontrib-napoleon.readthedocs.io/en/latest/) ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚

## b. æƒ³å®šèª­è€…

ä»¥ä¸‹ã®ã‚ˆã†ãªèª²é¡Œæ„Ÿã‚’ãŠæŒã¡ã®æ–¹ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚

* ãƒãƒ¼ãƒ é–‹ç™ºãªã©ã§è‡ªä½œã® Python ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’é–‹ç™ºã—ã¦ã„ã‚‹ãŒã€ãã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒå­˜åœ¨ã›ãšã€é‹ç”¨ã¨ã¨ã‚‚ã«æ•´å‚™ã—ãŸã„ã€‚
* ã¾ãŸã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯å­˜åœ¨ã™ã‚‹ãŒã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¨åˆ†é›¢ã—ã¦ãŠã‚Šçµ±åˆç®¡ç†ã§ãã¦ã„ãªã„ã€‚

## c. å‰æçŸ¥è­˜

æœ¬è¨˜äº‹ã§ã¯ docstring ãŠã‚ˆã³ Sphinx ã®åŸºæœ¬çš„ãªçŸ¥è­˜ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚ãã‚Œãã‚ŒãŒã©ã†ã„ã£ãŸã‚‚ã®ã‹ã®èª¬æ˜ã¯çœã„ã¦ã„ã¾ã™ãŒã€ç†è§£ã«ä¸å®‰ã®ã‚ã‚‹æ–¹ã¯ä»¥ä¸‹ã®è¨˜äº‹ãªã©ã‚’å‚è€ƒã«æ¦‚è¦ã‚’ã”ç¢ºèªãã ã•ã„ã€‚

**docstring**
* å‚è€ƒ: [Pythonã®docstringï¼ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æ–‡å­—åˆ—ï¼‰ã®æ›¸ãæ–¹ | note.nkmk.me](https://note.nkmk.me/python-docstring/)
* å‚è€ƒ: [[Python] docstringã®ã‚¹ã‚¿ã‚¤ãƒ«ã¨æ›¸ãæ–¹ | by @flcn-x, Qiita](https://qiita.com/flcn-x/items/393c6f1f1e1e5abec906)

**Sphinx**
* å‚è€ƒ: [sphinx ã§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆã‹ã‚‰Webå…¬é–‹ã¾ã§ã‚’ã‚„ã£ã¦ã¿ãŸ | by @kinpira | Qiita](https://qiita.com/kinpira/items/505bccacb2fba89c0ff0)
* å‚è€ƒ: [Sphinx ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™º : æ¨™æº–è¨­å®š | by @roki18d, Qiita](https://qiita.com/roki18d/items/6ac55b44a8b35be25e52)

## d. ãƒªã‚½ãƒ¼ã‚¹

æœ¬è¨˜äº‹ã§ä½¿ç”¨ã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹ã¯ã€GitHub ã«å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚

* [roki18d / sphinx_autogen_apidoc](https://github.com/roki18d/sphinx_autogen_apidoc)

## e. å‹•ä½œç¢ºèªç’°å¢ƒ

ç­†è€…ãŒå‹•ä½œç¢ºèªã‚’è¡Œã£ãŸç’°å¢ƒã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

```sh
# OS
% sw_vers 
ProductName:    macOS
ProductVersion: 12.0.1
BuildVersion:   21A559

# Python
% python --version
Python 3.7.6
```

## ç›®æ¬¡

* [1. æƒ³å®šæˆæœç‰©ã«ã¤ã„ã¦](#1-æƒ³å®šæˆæœç‰©ã«ã¤ã„ã¦)
* [2. è‡ªä½œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¤ã„ã¦](#2-è‡ªä½œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¤ã„ã¦)
* [3. å®Ÿæ–½æ‰‹é †](#3-å®Ÿæ–½æ‰‹é †)
* [4. è½ç©‚æ‹¾ã„](#4-è½ç©‚æ‹¾ã„)

# 1. æƒ³å®šæˆæœç‰©ã«ã¤ã„ã¦

## ä½•ã‚’ã™ã‚‹ã®ï¼Ÿ

è‡ªä½œ Python ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ã€

![](imgs/01-01_module-source.png)

ä»¥ä¸‹ã®ã‚ˆã†ãª Sphinx ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è‡ªå‹•ç”Ÿæˆã—ã¦ã„ãã¾ã™ã€‚

![](imgs/01-01_generated-docs.png)

## ãƒªã‚½ãƒ¼ã‚¹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

æœ¬è¨˜äº‹ã§ã¯ã€åˆæœŸçŠ¶æ…‹ã¨ã—ã¦ä»¥ä¸‹ã®ã‚ˆã†ãªçŠ¶æ…‹ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚

```sh
% tree
.
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â”œâ”€â”€ my_module               # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–‹ç™ºç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â”œâ”€â”€ exceptions.py
â”‚   â””â”€â”€ tools.py
â””â”€â”€ requirements.txt
```

æœ¬è¨˜äº‹ã®ã€[3. å®Ÿæ–½æ‰‹é †](#3-å®Ÿæ–½æ‰‹é †)ã€ã‚’å®Ÿæ–½ã™ã‚‹ã“ã¨ã§ã€`my_docs` ãŒä½œã‚‰ã‚Œã¾ã™ã€‚ãƒ“ãƒ«ãƒ‰ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒªã‚½ãƒ¼ã‚¹ã¯ `my_docs/build` ä»¥ä¸‹ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

```sh
% tree
.
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â”œâ”€â”€ my_docs                 # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé–‹ç™ºç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â”œâ”€â”€ Makefile                
â”‚   â”œâ”€â”€ build               #   - ãƒ“ãƒ«ãƒ‰å¾Œã«ç”Ÿæˆã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã®å‡ºåŠ›å…ˆ
â”‚   â””â”€â”€ source              #   - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆã«å¿…è¦ãªãƒªã‚½ãƒ¼ã‚¹ã®æ ¼ç´å ´æ‰€
â”‚       â”œâ”€â”€ _static
â”‚       â”œâ”€â”€ _templates
â”‚       â”œâ”€â”€ conf.py
â”‚       â”œâ”€â”€ index.rst
â”‚       â””â”€â”€ resources
â”œâ”€â”€ my_module               # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–‹ç™ºç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â”œâ”€â”€ exceptions.py
â”‚   â””â”€â”€ tools.py
â””â”€â”€ requirements.txt
```

# 2. è‡ªä½œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¤ã„ã¦

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆã‚’å®Ÿæ–½ã™ã‚‹å‰ã«ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ã®å¯¾è±¡ã¨ãªã‚‹è‡ªä½œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã©ã®ã‚ˆã†ãªã‚‚ã®ã‹ã€æœ¬ç« ã§ç°¡å˜ã«èª¬æ˜ã—ã¾ã™ã€‚

## 2-1. è‡ªä½œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®èª¬æ˜

ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã¯ `my_module` ã¨ã—ã¦ã„ã¾ã™ã€‚ä¾‹ã¨ã—ã¦ã€å››å‰‡æ¼”ç®—ã‚’å®Ÿè¡Œã™ã‚‹ `SimpleCalculator` ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã—ãŸ `tools.py` ã¨ã€ãã“ã‹ã‚‰åˆ©ç”¨ã•ã‚Œã‚‹ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã—ãŸ `exceptions.py` ã‚’ä½œæˆã—ã¦ã„ã¾ã™ã€‚ï¼ˆdocstring éƒ¨åˆ†ã«ä¸»çœ¼ã‚’ç½®ã„ã¦ã„ã‚‹ãŸã‚ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦ã®ä¸å‡ºæ¥ã¯ã”å®¹èµ¦ãã ã•ã„ğŸ™‡â€â™‚ï¸ï¼‰

**my_module/exceptions.py**

`Exception` ã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã—ãŸã ã‘ã® `InvalidArgumentsError` ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚ç”¨é€”ã¨ã—ã¦ã¯ã‚¯ãƒ©ã‚¹åã®é€šã‚Šã€ã‚¯ãƒ©ã‚¹ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ã«å¯¾ã—ã¦ç„¡åŠ¹ãªå¼•æ•°ãŒä¸ãˆã‚‰ã‚ŒãŸå ´åˆã«ä½¿ç”¨ã—ã¾ã™ã€‚

```python
#!/usr/bin/env python
# coding: utf-8

class InvalidArgumentsError(Exception):
    pass
```

**my_module/tools.py**

ä»¥ä¸‹ã¯ `tools.py` ã®ä¸€éƒ¨æŠœç²‹ã§ã™ã€‚ï¼ˆæ©Ÿèƒ½ã®æ¦‚è¦èª¬æ˜ã®ãŸã‚ docstring, ãŠã‚ˆã³ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆé–¢æ•°ã®å®Ÿè£…ã‚’çœç•¥ã—ã¦ã„ã¾ã™ï¼‰

```python
#!/usr/bin/env python
# coding: utf-8

from my_module.exceptions import InvalidArgumentsError

class SimpleCalculator(object): 
    
    def __init__(self, operator: str) -> None:
        valid_operators = ["add", "sub", "mul", "div"]
        if operator not in valid_operators:
            msg = f"Invalid operator '{operator}' was given, choose from {valid_operators}."
            raise InvalidArgumentsError(msg)
        else: 
            self.operator = operator
        self.response = dict()

    # 
    # (... çœç•¥ ...)
    # 

    def execute(self, num1: int, num2: int):
        # 
        # (... çœç•¥ ...)
        # 
        return self.response


if __name__ == "__main__":

    my_adder = SimpleCalculator(operator="add")
    print('Case01:', my_adder.execute(4, 2))
    print('Case02:', my_adder.execute(5, "a"))

    my_subtractor = SimpleCalculator(operator="sub")
    print('Case03:', my_subtractor.execute(3, 5))

    my_multiplier = SimpleCalculator(operator="mul")
    print('Case04:', my_multiplier.execute(2, 7))

    my_divider = SimpleCalculator(operator="div")
    print('Case05:', my_divider.execute(17, 5))
    print('Case06:', my_divider.execute(6, 0))

    print('Case07:')
    my_unknown = SimpleCalculator(operator="unknown")

    import sys; sys.exit(0)
```

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã—ã¦å®Ÿè¡Œã—ãŸå ´åˆã®å®Ÿè¡Œçµæœã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```sh
% python my_module/tools.py

Case01: {'operands': {'num1': 4, 'num2': 2}, 'results': {'sum': 6}}
Case02: {'operands': {'num1': 5, 'num2': 'a'}, 'results': {'error_message': TypeError("unsupported operand type(s) for +: 'int' and 'str'")}}
Case03: {'operands': {'num1': 3, 'num2': 5}, 'results': {'difference': -2}}
Case04: {'operands': {'num1': 2, 'num2': 7}, 'results': {'product': 14}}
Case05: {'operands': {'num1': 17, 'num2': 5}, 'results': {'quotient': 3, 'remainder': 2}}
Case06: {'operands': {'num1': 6, 'num2': 0}, 'results': {'error_message': ZeroDivisionError('integer division or modulo by zero')}}
Case07:
Traceback (most recent call last):
  File "my_module/tools.py", line 116, in <module>
    my_unknown = SimpleCalculator(operator="unknown")
  File "my_module/tools.py", line 29, in __init__
    raise InvalidArgumentsError(msg)
my_module.exceptions.InvalidArgumentsError: Invalid operator 'unknown' was given, choose from ['add', 'sub', 'mul', 'div'].
```

|ã‚±ãƒ¼ã‚¹ID|æŒ™å‹•|
|:--|:--|
|Case01|å¼•æ•° (4, 2) ã®å’Œ (sum) ãŒ `response` ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚|
|Case02|å¼•æ•°ã«æ•´æ•°ä»¥å¤–ã®å€¤ãŒå«ã¾ã‚Œã‚‹å ´åˆã€`TypeError` ãŒç™ºç”Ÿã—ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ `response` ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚|
|Case03|å¼•æ•° (3, 5) ã®å·® (difference) ãŒ `response` ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚|
|Case04|å¼•æ•° (2, 7) ã®ç© (product) ãŒ `response` ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚|
|Case05|å¼•æ•° (17, 5) ã®å•† (quontient) ãŠã‚ˆã³ ä½™ã‚Š (remainder) ãŒ `response` ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚|
|Case06|å‰²ã‚‹æ•°ãŒ 0 ã§ã‚ã‚‹å ´åˆã€`ZeroDivisionError` ãŒç™ºç”Ÿã—ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ `response` ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚|
|Case07|ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åˆæœŸåŒ–æ™‚ã«ä¸ãˆã‚‹å¼•æ•° (æ¼”ç®—å­æ–‡å­—åˆ—: operator) ãŒäº‹å‰å®šç¾©ã•ã‚ŒãŸã‚‚ã®ã§ãªã„å ´åˆã€ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤– `InvalidArgumentsError` ã‚’ç™ºç”Ÿã•ã›ã¾ã™ã€‚|

## 2-2. docstring ã‚¹ã‚¿ã‚¤ãƒ«

æœ¬ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã¯ã€docstring ã®ã‚¹ã‚¿ã‚¤ãƒ«ã¨ã—ã¦ Google Style ã‚’æ¡ç”¨ã—ã¾ã™ã€‚Napoleon ã¯ Google Style ã®ã»ã‹ã€NumPy Style ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

* [sphinx.ext.napoleon - Support for NumPy and Google style docstrings | sphinx-doc.org](https://www.sphinx-doc.org/en/master/usage/extensions/napoleon.html)
* Google Style: [Example Google Style Python Docstrings | sphinxcontrib-napoleon.readthedocs.io](https://sphinxcontrib-napoleon.readthedocs.io/en/latest/example_google.html)
* NumPy Style: [Example NumPy Style Python Docstrings | sphinxcontrib-napoleon.readthedocs.io](https://sphinxcontrib-napoleon.readthedocs.io/en/latest/example_numpy.html#example-numpy)

Google Style ã®è¨˜æ³•ã«å¾“ã„ã€`tools.py` ã® `SimpleCclculator` ã‚¯ãƒ©ã‚¹ã«å¯¾ã—ã¦ä»¥ä¸‹ã®ã‚ˆã†ãª docstring ã‚’è¨˜è¿°ã—ã¦ãŠãã¾ã™ã€‚

```python
class SimpleCalculator(object): 
    """SimpleCalculator

    SimpleCalculator is a simple calculator.  

    Attributes: 
        operator (str): 
            String that represents operation type. 
            Acceptable values are: {"add": addition, "sub": subtraction
            "mul": multiplication, "div": divide}
        response (dict): 
            Response for API execution. 
            This contains conditions (such as operands) and execution results. 
    """

    # 
    # (... çœç•¥ ...)
    # 

    def execute(self, num1: int, num2: int):
        """
        Interface to execute caluculation. 

        Args: 
            num1 (int): 1st operand. 
            num2 (int): 2nd operand. 

        Returns: 
            dict: self.response

        Raises: 
            InvalidArgumentsError: 

        Examples:
            >>> my_adder = SimpleCalculator(operator="add")
            >>> my_adder.execute(4, 2)
            {'operands': {'num1': 4, 'num2': 2}, 'results': {'sum': 6}}
        """
        # 
        # (... çœç•¥ ...)
        # 
```

# 3. å®Ÿæ–½æ‰‹é †

## 3-1. äº‹å‰æº–å‚™

é©å½“ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆä»¥ä¸‹ã€`$WORK_DIR`ï¼‰é…ä¸‹ã§ Git ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã€ç§»å‹•ã—ã¾ã™ã€‚

```sh
% cd $WORKDIR
% git clone https://github.com/roki18d/sphinx_autogen_apidoc.git
% cd sphinx_autogen_apidoc.git
```

æœ¬æ‰‹é †ã®å®Ÿæ–½ã«ã‚ˆã£ã¦ä½œæˆã•ã‚Œã‚‹ãƒªã‚½ãƒ¼ã‚¹ãŒæ—¢ã«å­˜åœ¨ã™ã‚‹ãŸã‚ã€å®Ÿæ–½å‰ã«å‰Šé™¤ã—ã¦ãŠãã¾ã™ã€‚ï¼ˆã¾ãŸã¯ `my_docs` ã‚’ `my_docs2` ãªã©ã€åˆ¥åã«èª­ã¿æ›¿ãˆã¦å®Ÿæ–½ã—ã¦ãã ã•ã„ï¼‰

```sh
% rm -rf my_docs
```

å¿…è¦ã«å¿œã˜ã¦ã€pyenv ã‚„ conda ç­‰ã® Python ä»®æƒ³ç’°å¢ƒã«ã‚¹ã‚¤ãƒƒãƒã—ã¾ã™ã€‚æœ¬è¨˜äº‹ã§ã¯äºˆã‚ä½œæˆã—ã¦ã„ã‚‹ `sphinx` ã¨ã„ã† pyenv ä»®æƒ³ç’°å¢ƒã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```sh
% pyenv local sphinx
(sphinx) % python --version
Python 3.7.6
```

å®Ÿæ–½ã«å¿…è¦ãª Python ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```sh
% pip install -U pip
% pip install -r requirements.txt
```


## 3-2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

`sphinx-quickstart` ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚

```sh 
% sphinx-quickstart my_docs \
    --sep \
    --project "My Docs" \
    --author "{Your Name}" \
    -v 0.1 \
    --release 0.1 \
    --language='en' \
    --no-batchfile
```

ã‚ªãƒ—ã‚·ãƒ§ãƒ³å¼•æ•°ã‚’ä¸ãˆãšã€å„è¨­å®šå†…å®¹ã‚’ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
ã‚ªãƒ—ã‚·ãƒ§ãƒ³å¼•æ•°ã§è¨­å®šå¯èƒ½ãªé …ç›®ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’ã”ç¢ºèªãã ã•ã„ã€‚

* [sphinx-quickstart | sphinx-doc.org](https://www.sphinx-doc.org/en/master/man/sphinx-quickstart.html)

## 3-3. `conf.py` ã®ç·¨é›†

Sphinx ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ€ãƒ¼ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« `conf.py` ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ç·¨é›†ã—ã¾ã™ã€‚
å¿…è¦ã«å¿œã˜ã¦è¨­å®šå†…å®¹ã‚’å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚

**my_docs/source/conf.py**

```python
# Configuration file for the Sphinx documentation builder.

# -- Path setup --------------------------------------------------------------
# import os
# import sys
# sys.path.insert(0, os.path.abspath('.'))
import sphinx_rtd_theme
import sphinx_fontawesome

# -- Project information -----------------------------------------------------
project = 'My Docs'
copyright = '2022, {Your Name}'
author = '{Your Name}'
version = '0.1'
release = '0.1'

# -- General configuration ---------------------------------------------------
extensions = [
    'sphinx.ext.autodoc', 
    'sphinx.ext.napoleon', 
    'sphinx_rtd_theme', 
    'sphinx_fontawesome', 
    'myst_parser', 
]
source_suffix = {
    '.rst': 'restructuredtext',
    '.md': 'markdown',
}

exclude_patterns = ['_build', 'Thumbs.db', '.DS_Store']
exclude_patterns = []

# -- Options for HTML output -------------------------------------------------
html_theme = "sphinx_rtd_theme"
html_theme_path = [sphinx_rtd_theme.get_html_theme_path()]
html_show_sourcelink = False
html_static_path = ['_static']
```

## 3-4. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã®ç”Ÿæˆ

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚½ãƒ¼ã‚¹æ ¼ç´ç”¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™ã€‚
ï¼ˆ`docs/source` ç›´ä¸‹ã«æ ¼ç´ã—ã¦ã‚‚è‰¯ã„ã®ã§ã™ãŒã€æˆæœç‰©å…¨ä½“ã®è¦‹é€šã—ãŒæ‚ªããªã‚‹ãŸã‚ã€å°‚ç”¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¦ã„ã¾ã™ï¼‰

```sh
% mkdir my_docs/source/resources
```

`sphinx-apidoc` ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚

```
% sphinx-apidoc --force -o my_docs/source/resources my_module
Creating file my_docs/source/resources/exceptions.rst.
Creating file my_docs/source/resources/tools.rst.
Creating file my_docs/source/resources/modules.rst
```

`sphinx-apidoc` ã‚³ãƒãƒ³ãƒ‰ã®èª¬æ˜ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚è©³ç´°ã¯ä¸‹è¨˜ãƒªãƒ³ã‚¯ã‚’ã”ç¢ºèªãã ã•ã„ã€‚

> **sphinx-apidoc** is a tool for automatic generation of Sphinx sources that, using the autodoc extension, document a whole package in the style of other automatic API documentation tools.

* [sphinx-apidoc | sphinx-doc.org](https://www.sphinx-doc.org/en/master/man/sphinx-apidoc.html)

## 3-5. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã®ç·¨é›†

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ç·¨é›†ã—ã¾ã™ã€‚

**my_docs/resources/exceptions.rst**

```rest
my_module.exceptions
====================

.. automodule:: my_module.exceptions
   :members:
   :undoc-members:
   :show-inheritance:
```

**my_docs/resources/tools.rst**

```rest
my_module.tools
===============

.. automodule:: my_module.tools
   :members:
   :undoc-members:
   :show-inheritance:
```

**my_docs/resources/modules.rst**

```rest
my_module
=========

.. toctree::
   :maxdepth: 4

   exceptions
   tools
```

**my_docs/index.rst**

```rest
My Docs
============================================================

.. toctree::
   :maxdepth: 2
   :caption: Contents:

   resources/modules.rst
```

## 3-6. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã®ãƒ“ãƒ«ãƒ‰

`sphinx-build` ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã‚’ãƒ“ãƒ«ãƒ‰ã—ã¾ã™ã€‚

```sh
% sphinx-build -b html my_docs/source my_docs/build 
Running Sphinx v4.3.1

# (... çœç•¥ ...)

build succeeded.

The HTML pages are in my_docs/build.
```

ãƒ–ãƒ©ã‚¦ã‚¶ã§ `my_docs/build/index.html` ã‚’é–‹ãã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

![](imgs/03-06_generated-docs.png)

# 4. è½ç©‚æ‹¾ã„

## 4-1. ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ¡ã‚½ãƒƒãƒ‰

ã‚¯ãƒ©ã‚¹å†…ã«å®Ÿè£…ã—ãŸãƒ¡ã‚½ãƒƒãƒ‰ã®ã†ã¡ã€ãƒ¡ã‚½ãƒƒãƒ‰åå…ˆé ­ã«ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢2ã¤ãŒã¤ã„ã¦ã„ã‚‹ã‚‚ã® (ä¾‹: `__hoge()`) ã¯ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦èªè­˜ã•ã‚Œã€å¤–éƒ¨ã‹ã‚‰ã®ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ãŒå‡ºæ¥ãªããªã‚Šã¾ã™ã€‚ã¾ãŸã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ Sphinx ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆã®å¯¾è±¡å¤–ã¨ãªã‚Šã¾ã™ã€‚

æœ¬è¨˜äº‹ã§ä½¿ç”¨ã—ãŸ `SimpleCalculator` ã‚¯ãƒ©ã‚¹ã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã—ãŸã€‚

|ãƒ¡ã‚½ãƒƒãƒ‰å|æ¦‚è¦|
|:--|:--|
|`__add()`|åŠ ç®—å‡¦ç†ã‚’å®Ÿè£…ã—ãŸå†…éƒ¨ãƒ¡ã‚½ãƒƒãƒ‰|
|`__sub()`|æ¸›ç®—å‡¦ç†ã‚’å®Ÿè£…ã—ãŸå†…éƒ¨ãƒ¡ã‚½ãƒƒãƒ‰|
|`__mul()`|ä¹—ç®—å‡¦ç†ã‚’å®Ÿè£…ã—ãŸå†…éƒ¨ãƒ¡ã‚½ãƒƒãƒ‰|
|`__div()`|é™¤ç®—å‡¦ç†ã‚’å®Ÿè£…ã—ãŸå†…éƒ¨ãƒ¡ã‚½ãƒƒãƒ‰|
|`__handle_exceptions()`|ä¾‹å¤–ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å®Ÿè£…ã—ãŸå†…éƒ¨ãƒ¡ã‚½ãƒƒãƒ‰|

ãƒ¦ãƒ¼ã‚¶ã«æ„è­˜ã•ã›ã‚‹å¿…è¦ã®ãªã„å†…éƒ¨ãƒ¡ã‚½ãƒƒãƒ‰ã¯ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦å®Ÿè£…ã—ã¦ãŠãã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆã®å¯¾è±¡ã‹ã‚‰ã‚‚å¤–ã—ã¦ãŠãã¨è‰¯ã„ã§ã—ã‚‡ã†ã€‚

## 4-2. è‡ªå‹•ãƒ“ãƒ«ãƒ‰

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã‚’ç·¨é›†ã™ã‚‹ãŸã³ã«ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã®ãŒé¢å€’ãªå ´åˆã€`sphinx-autobuild` ã®æ©Ÿèƒ½ã‚’åˆ©ç”¨ã—ã¦è‡ªå‹•ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã“ã©ãŒã§ãã¾ã™ã€‚

```sh
% sphinx-autobuild my_docs/source my_docs/build

# (... çœç•¥ ...)
build succeeded.

The HTML pages are in my_docs/build.
[I 220102 17:39:56 server:335] Serving on http://127.0.0.1:8000
```

ã“ã®çŠ¶æ…‹ã§ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ `http://127.0.0.1:8000` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€é€šå¸¸ãƒ“ãƒ«ãƒ‰åŒæ§˜ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã‚’ç·¨é›†ãƒ»ä¿å­˜ã™ã‚‹ãŸã³ã«ãƒšãƒ¼ã‚¸ãŒæ›´æ–°ã•ã‚Œã¾ã™ã€‚

# ã•ã„ã”ã«

Python ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ãƒãƒ¼ãƒ ã§é–‹ç™ºã™ã‚‹ã‚ˆã†ã«ãªã‚‹ã¨ã€è¦æ¨¡ãŒå¤§ãããªã‚‹ã«ã¤ã‚Œã¦ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å…¨å®¹ã‚’æŠŠæ¡ã™ã‚‹ã®ãŒé›£ã—ããªã£ã¦ãã¾ã™ã€‚ãã®ãŸã‚ã€å¿…è¦ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä½¿ã„æ–¹ã‚’å‚ç…§ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãŠãã“ã¨ãŒé‡è¦ã§ã™ã€‚ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè‡ªå‹•ç”Ÿæˆã¯ã€å†…å®¹ã®æ­£ç¢ºæ€§ã‚’æ‹…ä¿ã—ã¤ã¤ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã®é‹ç”¨ã‚’ç°¡ç´ åŒ–ã™ã‚‹ã®ã«éå¸¸ã«æœ‰åŠ¹ã ã¨æ€ã„ã¾ã™ã€‚

2022å¹´ä¸€æœ¬ç›®ã®æŠ•ç¨¿ã¨ãªã‚Šã¾ã—ãŸãŒã€ä»Šå¹´ã¯ã‚³ãƒ¼ãƒ‰è‡ªå‹•ç”ŸæˆæŠ€è¡“ã®å‹•å‘ã«ã‚‚ã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚

æœ€å¾Œã¾ã§ã”è¦§é ‚ãã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚

# å‚è€ƒ

* [Sphinxã®ä½¿ã„æ–¹ï¼docstringã‚’èª­ã¿è¾¼ã‚“ã§ä»•æ§˜æ›¸ã‚’ç”Ÿæˆ | by @futakuchi0117, Qiita](https://qiita.com/futakuchi0117/items/4d3997c1ca1323259844)
* [doctest --- å¯¾è©±çš„ãªå®Ÿè¡Œä¾‹ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ | docs.python.org](https://docs.python.org/ja/3/library/doctest.html)



---
EOF
