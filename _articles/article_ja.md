

# ã¯ã˜ã‚ã«

## a. è¨˜äº‹æ¦‚è¦

* è‡ªä½œ Python ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰è‡ªå‹•ç”Ÿæˆã—ã¦ã„ãã¾ã™ã€‚
* ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆãƒ„ãƒ¼ãƒ«ã§ã‚ã‚‹ [Sphinx](https://www.sphinx-doc.org/en/master/) ãŠã‚ˆã³ã€ãã®æ‹¡å¼µæ©Ÿèƒ½ã§ã‚ã‚‹ [Napoleon](https://sphinxcontrib-napoleon.readthedocs.io/en/latest/) ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚

## b. æƒ³å®šèª­è€…

ä»¥ä¸‹ã®ã‚ˆã†ãªèª²é¡Œæ„Ÿã‚’ãŠæŒã¡ã®æ–¹ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚

* ãƒãƒ¼ãƒ é–‹ç™ºãªã©ã§è‡ªä½œã® Python ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’é–‹ç™ºã—ã¦ã„ã‚‹ãŒã€ãã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒå­˜åœ¨ã›ãšã€é‹ç”¨ã¨ã¨ã‚‚ã«æ•´å‚™ã—ãŸã„ã€‚
* ã¾ãŸã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯å­˜åœ¨ã™ã‚‹ãŒã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¨åˆ†é›¢ã—ã¦ãŠã‚Š çµ±åˆç®¡ç†ã§ãã¦ã„ãªã„ã€‚

## c. å‰æçŸ¥è­˜

æœ¬è¨˜äº‹ã§ã¯ docstring ãŠã‚ˆã³ Sphinx ã®åŸºæœ¬çš„ãªçŸ¥è­˜ã‚’å‰æã¨ã—ã€ãã‚Œãã‚Œè‡ªä½“ãŒä½•ã‹ã¨ã„ã£ãŸèª¬æ˜ã¯çœã„ã¦ã„ã¾ã™ã€‚ç†è§£ã«ä¸å®‰ã®ã‚ã‚‹æ–¹ã¯ã€ä»¥ä¸‹ã®è¨˜äº‹ãªã©ã‚’å‚è€ƒã«æ¦‚è¦ã‚’ã”ç¢ºèªãã ã•ã„ã€‚

**docstring**
* å‚è€ƒ: [Pythonã®docstringï¼ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æ–‡å­—åˆ—ï¼‰ã®æ›¸ãæ–¹ | note.nkmk.me](https://note.nkmk.me/python-docstring/)
* å‚è€ƒ: [[Python] docstringã®ã‚¹ã‚¿ã‚¤ãƒ«ã¨æ›¸ãæ–¹ | by @flcn-x, Qiita](https://qiita.com/flcn-x/items/393c6f1f1e1e5abec906)

**Sphinx**
* å‚è€ƒ: [sphinx ã§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆã‹ã‚‰Webå…¬é–‹ã¾ã§ã‚’ã‚„ã£ã¦ã¿ãŸ | by @kinpira | Qiita](https://qiita.com/kinpira/items/505bccacb2fba89c0ff0)
* å‚è€ƒ: [Sphinx ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™º : æ¨™æº–è¨­å®š | by @roki18d, Qiita](https://qiita.com/roki18d/items/6ac55b44a8b35be25e52)

## d. ãƒªã‚½ãƒ¼ã‚¹

æœ¬è¨˜äº‹ã§ä½¿ç”¨ã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹ã¯ã€GitHub ã«å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚

* [roki18d / sphinx_autogen_apidoc](https://github.com/roki18d/sphinx_autogen_apidoc)

## e. å‹•ä½œç¢ºèªç’°å¢ƒ

ç­†è€…ãŒå‹•ä½œç¢ºèªã‚’è¡Œã£ãŸç’°å¢ƒã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

```
# OS
% sw_vers 
ProductName:    macOS
ProductVersion: 12.0.1
BuildVersion:   21A559

# Python
% python --version
Python 3.7.6
```

## ç›®æ¬¡

# 1. æƒ³å®šæˆæœç‰©ã«ã¤ã„ã¦

## ä½•ã‚’ã™ã‚‹ã®ï¼Ÿ

è‡ªä½œ Python ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰...

![](imgs/01-01_python-module-source.png)

ä»¥ä¸‹ã®ã‚ˆã†ãª Sphinx ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è‡ªå‹•ç”Ÿæˆã—ã¦ã„ãã¾ã™ã€‚

![](imgs/01-01_generated-docs.png)

## ãƒªã‚½ãƒ¼ã‚¹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

æœ¬è¨˜äº‹ã§ã¯ã€åˆæœŸçŠ¶æ…‹ã¨ã—ã¦ä»¥ä¸‹ã®ã‚ˆã†ãªçŠ¶æ…‹ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚

```
% tree
.
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â”œâ”€â”€ my_module               # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–‹ç™ºç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â”œâ”€â”€ exceptions.py
â”‚   â””â”€â”€ tools.py
â””â”€â”€ requirements.txt
```

æœ¬è¨˜äº‹ã®ã€[3. å®Ÿæ–½æ‰‹é †]()ã€ã‚’å®Ÿæ–½ã™ã‚‹ã“ã¨ã§ã€`my_docs` ãŒä½œã‚‰ã‚Œã¾ã™ã€‚ãƒ“ãƒ«ãƒ‰ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒªã‚½ãƒ¼ã‚¹ã¯ `my_docs/build` ä»¥ä¸‹ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

```
% tree
.
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â”œâ”€â”€ my_docs                 # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé–‹ç™ºç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â”œâ”€â”€ Makefile                
â”‚   â”œâ”€â”€ build               #   - ãƒ“ãƒ«ãƒ‰å¾Œã«ç”Ÿæˆã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã®å‡ºåŠ›å…ˆ
â”‚   â””â”€â”€ source              #   - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆã«å¿…è¦ãªãƒªã‚½ãƒ¼ã‚¹ã®æ ¼ç´å ´æ‰€
â”‚       â”œâ”€â”€ _static
â”‚       â”œâ”€â”€ _templates
â”‚       â”œâ”€â”€ conf.py
â”‚       â”œâ”€â”€ index.rst
â”‚       â””â”€â”€ resources
â”œâ”€â”€ my_module               # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–‹ç™ºç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â”œâ”€â”€ exceptions.py
â”‚   â””â”€â”€ tools.py
â””â”€â”€ requirements.txt
```

# 2. è‡ªä½œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¤ã„ã¦

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆã‚’å®Ÿæ–½ã™ã‚‹å‰ã«ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ã®å¯¾è±¡ã¨ãªã‚‹è‡ªä½œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã©ã®ã‚ˆã†ãªã‚‚ã®ã‹ã€æœ¬ç« ã§ç°¡å˜ã«èª¬æ˜ã—ã¾ã™ã€‚

## 2-1. è‡ªä½œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®èª¬æ˜

ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã¯ `my_module` ã¨ã—ã¦ã„ã¾ã™ã€‚ä¾‹ã¨ã—ã¦ã€å››å‰‡æ¼”ç®—ã‚’å®Ÿè¡Œã™ã‚‹ `SimpleCalculator` ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã—ãŸ `tools.py` ã¨ã€ãã“ã‹ã‚‰åˆ©ç”¨ã•ã‚Œã‚‹ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã—ãŸ `exceptions.py` ã‚’ä½œæˆã—ã¦ã„ã¾ã™ã€‚ï¼ˆdocstring éƒ¨åˆ†ã«ä¸»çœ¼ã‚’ç½®ã„ã¦ã„ã‚‹ãŸã‚ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦ä¸å‡ºæ¥ã¯ã”å®¹èµ¦ãã ã•ã„ğŸ™‡â€â™‚ï¸ï¼‰

**tools.py**

ä»¥ä¸‹ã¯ `tools.py` ã®ä¸€éƒ¨æŠœç²‹ã§ã™ã€‚ï¼ˆæ©Ÿèƒ½ã®æ¦‚è¦èª¬æ˜ã®ãŸã‚ docstring, ãŠã‚ˆã³ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆé–¢æ•°ã®å®Ÿè£…ã‚’çœç•¥ã—ã¦ã„ã¾ã™ï¼‰

```python
#!/usr/bin/env python
# coding: utf-8

from my_module.exceptions import InvalidArgumentsError

class SimpleCalculator(object): 
    
    def __init__(self, operator: str) -> None:
        valid_operators = ["add", "sub", "mul", "div"]
        if operator not in valid_operators:
            msg = f"Invalid operator '{operator}' was given, choose from {valid_operators}."
            raise InvalidArgumentsError(msg)
        else: 
            self.operator = operator
        self.response = dict()

    # 
    # (... çœç•¥ ...)
    # 

    def execute(self, num1: int, num2: int):
        # 
        # (... çœç•¥ ...)
        # 
        return self.response


if __name__ == "__main__":

    my_adder = SimpleCalculator(operator="add")
    print('Case01:', my_adder.execute(4, 2))
    print('Case02:', my_adder.execute(5, "a"))

    my_subtractor = SimpleCalculator(operator="sub")
    print('Case03:', my_subtractor.execute(3, 5))

    my_multiplier = SimpleCalculator(operator="mul")
    print('Case04:', my_multiplier.execute(2, 7))

    my_divider = SimpleCalculator(operator="div")
    print('Case05:', my_divider.execute(17, 5))
    print('Case06:', my_divider.execute(6, 0))

    print('Case07:')
    my_unknown = SimpleCalculator(operator="unknown")

    import sys; sys.exit(0)
```

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã—ã¦å®Ÿè¡Œã—ãŸå ´åˆã®å®Ÿè¡Œçµæœã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```bash
% python my_module/tools.py

Case01: {'operands': {'num1': 4, 'num2': 2}, 'results': {'sum': 6}}
Case02: {'operands': {'num1': 5, 'num2': 'a'}, 'results': {'error_message': TypeError("unsupported operand type(s) for +: 'int' and 'str'")}}
Case03: {'operands': {'num1': 3, 'num2': 5}, 'results': {'difference': -2}}
Case04: {'operands': {'num1': 2, 'num2': 7}, 'results': {'product': 14}}
Case05: {'operands': {'num1': 17, 'num2': 5}, 'results': {'quotient': 3, 'remainder': 2}}
Case06: {'operands': {'num1': 6, 'num2': 0}, 'results': {'error_message': ZeroDivisionError('integer division or modulo by zero')}}
Case07:
Traceback (most recent call last):
  File "my_module/tools.py", line 116, in <module>
    my_unknown = SimpleCalculator(operator="unknown")
  File "my_module/tools.py", line 29, in __init__
    raise InvalidArgumentsError(msg)
my_module.exceptions.InvalidArgumentsError: Invalid operator 'unknown' was given, choose from ['add', 'sub', 'mul', 'div'].
```

|ã‚±ãƒ¼ã‚¹|æŒ™å‹•|
|:--|:--|
|Case01|å¼•æ•° (4, 2) ã®å’Œ (sum) ãŒ `response` ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚|
|Case02|å¼•æ•°ã«æ•´æ•°ä»¥å¤–ã®å€¤ãŒå«ã¾ã‚Œã‚‹å ´åˆã€`TypeError` ãŒç™ºç”Ÿã—ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ `response` ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚|
|Case03|å¼•æ•° (3, 5) ã®å·® (difference) ãŒ `response` ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚|
|Case04|å¼•æ•° (2, 7) ã®ç© (product) ãŒ `response` ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚|
|Case05|å¼•æ•° (17, 5) ã®å•† (quontient) ãŠã‚ˆã³ ä½™ã‚Š (remainder) ãŒ `response` ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚|
|Case06|å‰²ã‚‹æ•°ãŒ 0 ã§ã‚ã‚‹å ´åˆã€`ZeroDivisionError` ãŒç™ºç”Ÿã—ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ `response` ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚|
|Case07|ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åˆæœŸåŒ–æ™‚ã«ä¸ãˆã‚‹å¼•æ•° (æ¼”ç®—å­æ–‡å­—åˆ—: operator) ãŒäº‹å‰å®šç¾©ã•ã‚ŒãŸã‚‚ã®ã§ãªã„å ´åˆã€ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤– `InvalidArgumentsError` ã‚’ç™ºç”Ÿã•ã›ã¾ã™ã€‚|

## 2-2. docstring ã‚¹ã‚¿ã‚¤ãƒ«

æœ¬ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã¯ã€docstring ã®ã‚¹ã‚¿ã‚¤ãƒ«ã¨ã—ã¦ Google Style ã‚’æ¡ç”¨ã—ã¾ã™ã€‚å¾Œè¿°ã® Napoleon ã¯ã€Google Style ã®ã»ã‹ã€NumPy Style ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

* Google Style: [Example Google Style Python Docstrings | sphinxcontrib-napoleon.readthedocs.io](https://sphinxcontrib-napoleon.readthedocs.io/en/latest/example_google.html)
* NumPy Style: [Example NumPy Style Python Docstrings | sphinxcontrib-napoleon.readthedocs.io](https://sphinxcontrib-napoleon.readthedocs.io/en/latest/example_numpy.html#example-numpy)

Google Style ã®è¨˜æ³•ã«å¾“ã„ã€`tools.py` ã® `SimpleCclculator` ã‚¯ãƒ©ã‚¹ã«å¯¾ã—ã¦ä»¥ä¸‹ã®ã‚ˆã†ãª docstring ã‚’è¨˜è¿°ã—ã¦ãŠãã¾ã™ã€‚

```python
class SimpleCalculator(object): 
    """SimpleCalculator

    SimpleCalculator is a simple calculator.  

    Attributes: 
        operator (str): 
            String that represents operation type. 
            Acceptable values are: {"add": addition, "sub": subtraction
            "mul": multiplication, "div": divide}
        response (dict): 
            Response for API execution. 
            This contains conditions (such as operands) and execution results. 
    """

    # 
    # (... çœç•¥ ...)
    # 

    def execute(self, num1: int, num2: int):
        """
        Interface to execute caluculation. 

        Args: 
            num1 (int): 1st operand. 
            num2 (int): 2nd operand. 

        Returns: 
            dict: self.response

        Raises: 
            InvalidArgumentsError: 

        Examples:
            >>> my_adder = SimpleCalculator(operator="add")
            >>> my_adder.execute(4, 2)
            {'operands': {'num1': 4, 'num2': 2}, 'results': {'sum': 6}}
        """
        # 
        # (... çœç•¥ ...)
        # 
```

# 3. å®Ÿæ–½æ‰‹é †

# 4. è½ã¡ç©‚æ‹¾ã„

## 4-1. ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆé–¢æ•°



# ã•ã„ã”ã«

# å‚è€ƒ

* [Sphinxã®ä½¿ã„æ–¹ï¼docstringã‚’èª­ã¿è¾¼ã‚“ã§ä»•æ§˜æ›¸ã‚’ç”Ÿæˆ | by @futakuchi0117, Qiita](https://qiita.com/futakuchi0117/items/4d3997c1ca1323259844)
* [doctest --- å¯¾è©±çš„ãªå®Ÿè¡Œä¾‹ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ | docs.python.org](https://docs.python.org/ja/3/library/doctest.html)



---
EOF
